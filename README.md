
# 2D Fluid Flow Simulation using Regularized Stokeslets

This repository contains MATLAB and Python code to simulate and analyze 2D fluid flow using the method of Regularized Stokeslets.

## Description
The core of this project is to model and understand fluid dynamics in a 2D environment. It calculates the trajectories of particles within a fluid flow generated by a set of Regularized Stokeslets. The primary application seems to be determining which particles are "captured" by spending a sufficient amount of time near appendages within the flow.

## Installation
To run this project, you will need:
MATLAB: The main simulation is written in MATLAB.
Python: The auxiliary scripts for parameter generation and sensitivity analysis are in Python. The sobol.py script uses the SALib library for Sobol parameter generation and sensitivity analysis.

## Usage
- Set Parameters: Modify the parameters.m file to define the simulation parameters, such as the geometry, number of Stokeslets, and time-stepping details.
- Run Simulation:
-- Directly in MATLAB: CalculateTrajectory(index) where index corresponds to a parameter set from the input file (see input/).
-- From the command line: The runFunction.sh file is intended to run the MATLAB function from a terminal, which is common in both macOS and Linux. Although the script is empty, a typical command would look like this:
    matlab -nodisplay -nosplash -nodesktop -r "CalculateTrajectory(1);exit;"
- Analyze Output: The output of the simulation is saved in the outputs directory. You can then use the calculate_metrics.m script to analyze the generated data.

# File Descriptions

## Core Scripts
- CalculateTrajectory.m: The main script that runs the fluid flow simulation and particle tracking.
- parameters.m: A MATLAB script to define all the necessary parameters for the simulation.
- calculate_metrics.m: A MATLAB script to load and analyze the output data from the simulations.

## Functions
The functions directory contains the core MATLAB functions used in the simulation:
- calculateFlowVector.m: Calculates the flow profile from the Stokeslets.
- getForces.m: Solves the inverse problem to determine the forces of the Stokeslets.
- getStokesletPositions.m: Initializes the positions of the Stokeslets for the given geometry.
- geometry_cylinderPair.m: Defines a geometry with a pair of cylinders.
- geometry_poisuelle.m: Initializes the geometry of a channel with a contraction.
- poisuelleFlow.m: Related to Poiseuille flow calculations.
- surfaceFlow.m: Calculates the flow on the surface of the appendages.

## Auxiliary Scripts
The aux_scripts directory contains Python scripts for more advanced analysis:
- Generate_sobol_parameters.py: Generates Sobol sequence parameters for sensitivity analysis.
- sobol.py: Implements Sobol sensitivity analysis, using the SALib library.
## Input/Output
- inputs/: This directory holds text files with parameter sets for running multiple simulations. Currently contains parameter set used in figures 6/7.
- outputs/: This is where the simulation output files are stored. Here, outputs1 is the total time, and outputs2 is the max time. The data present was used in figure 6/7.

## Other
- classes/geometry.m: Provides objects for defining geometries.
- runFunction.sh: A shell script for running the MATLAB simulation from the command line.

## Parameters
The parameters.m file is the central place for configuring a simulation. Key parameters include:
- Geometry: Defines the shape of the domain (e.g., 'cylinder_pair', 'poisuelle').
- Number of Stokeslets: The number of regularized Stokeslets used to model the flow.
- Particle tracking parameters: Initial positions of particles, time step, and total simulation time.
